{% extends 'base.html' %}
{% load i18n %}
{% block title %}{{ ticket.title }}{% endblock %}
{% block content %}
      <div id="ticket">
        <h3>{{ ticket.title }}</h3>
        <h5>Ticket ID{{ ticket.id }}</h5>
        <h5>{% trans 'Status:' %} {{ ticket.get_status_display }}{% if not ticket.is_closed %} (<a href="{% url close_ticket ticket.id %}">{% trans 'Close' %}</a>){% endif %}{% if ticket.is_closed %} (<a onclick="Effect.toggle('reply_form', 'blind')">{% trans 'Reopen' %}</a>){% endif %}
</h5>
        <div class="messages">
          <div class="info_row owner">{% trans 'Initial message' %}<br />{% trans 'Date:' %} {{ ticket.date|date:"j F Y, G:i" }}</div>
          <div class="text_row">{{ ticket.text }}</div>
{% for msg in ticket.messages.all %}
          <div class="info_row {% ifequal ticket.owner msg.user %}owner{% else %}reply{% endifequal %}">{% ifequal ticket.owner msg.user %}{% trans 'From you' %}{% else %}{% trans 'From help desk' %}{% endifequal %}<br />{% trans 'Date:' %} {{ msg.date|date:"j F Y, G:i" }}</div>
          <div class="text_row">{{ msg.text }}</div>
{% endfor %}
        </div>
      </div>
{% if form.errors %}
{{ form.errors }}
{% endif %}
      <br />
      <div id="reply_form"{% if ticket.is_closed %} style="display:none"{% endif %}>
        <span>{% trans 'Reply' %}</span>
        <form action="{% url reply_ticket ticket.id %}" method="post">
        <table>
          <tr><td>{{ form.text }}</td></tr>
          <tr><td><input type="submit" value="{% trans 'Send' %}"/></td></tr>
        </table>
        </form>
      </div>
      <br /><a href="{% url help_index %}">{% trans 'Go back to help index.' %}</a>
{% endblock %}
