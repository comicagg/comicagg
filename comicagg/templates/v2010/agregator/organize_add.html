{% extends 'agregator/organize_base.html' %}
{% load i18n agregator_tags %}
{% block title %}{% trans 'Choose' %} - {% endblock %}
{% block extra_head %}
		<script src="http://ajax.googleapis.com/ajax/libs/dojo/1.4/dojo/dojo.xd.js" type="text/javascript"></script>
		<script src="{{ mediaurl}}js/v2010/organize.js" type="text/javascript"></script>
		<script type="text/javascript">
var usercomics = [
{% for comic in user_comics %}
	{'id':{{ comic.id}}, 'name':"{{ comic.name|escape }}", 'slug':"{{ comic.name|slugify }}", 'score':{{ comic.getRating|perc:2 }}, 'votes':{{ comic.votes }}, 'noimages':{{ comic.noimages }}, 'url': "{{ comic.url }}", 'updated':"{{ comic.last_check|date:"j F, Y" }}", 'readers':{{ comic.readers }}, 'last':"{{ comic.get_url|safe}}"},
{% endfor %}
];
var newcomics = usercomics.clone();
var removedcomics = new Array();
var addedcomics = new Array();
var availablecomics = [
{% for comic in all_comics %}
	{'id':{{ comic.id}}, 'name':"{{ comic.name|escape }}", 'slug':"{{ comic.name|slugify }}", 'score':{{ comic.getRating|perc:2 }}, 'votes':{{ comic.votes }}, 'noimages':{{ comic.noimages }}, 'url': "{{ comic.url }}", 'updated':"{{ comic.last_check|date:"j F, Y" }}", 'readers':{{ comic.readers }}, 'last':"{{ comic.get_url|safe }}"},
{% endfor %}
];
var available_new = [
{% for newcomic in new_comics %}
	{'id':{{ newcomic.comic.id}}, 'name':"{{ newcomic.comic.name|escape }}", 'slug':"{{ newcomic.comic.name|slugify }}", 'score':{{ newcomic.comic.getRating|perc:2 }}, 'votes':{{ newcomic.comic.votes }}, 'noimages':{{ newcomic.comic.noimages }}, 'url': "{{ newcomic.comic.url }}", 'updated':"{{ newcomic.comic.last_check|date:"j F, Y" }}", 'readers':{{ newcomic.comic.readers }}, 'last':"{{ newcomic.comic.get_url|safe }}"},
{% endfor %}
];
dojo.addOnLoad(initAdd);
		</script>
{% endblock%}
{% block onload %}{% endblock %}
{% block orgcontent %}
<div id="add">
	<h3>{% trans "Add comics" %}</h3>
	<div id="comic_info">
		<div id="comic_info_wrap" style="display:none">
			<h3 id="comic_name"></h3>
			<h4 id="comic_new">{% trans "New comic!" %}</h4>
			<p>{% trans "Score" %}: <b><span id="comic_score">{{ comic.getRating }}</span>%</b> (<span id="comic_votes">{{ comic.votes }}</span> {% trans "votes" %})</p>
			<p>{% trans "Readers" %}: <b><span id="comic_readers">{{ comic.readers }}</span></b></p>
			<p><a id="comic_url">{% trans "Link to its website"%}</a></p>
			<p>{% trans "Last update:" %}&nbsp;<b><span id="comic_updated"></span></b></p>
			<p id="comic_image">
				<img id="loading" src="{{ mediaurl }}images/loading.gif" alt="" style="display:none"/>
				<img id="comic_last" src="" alt="" title="" style="display:none"/>
			</p>
			<p id="noimages" style="display:none">{% trans "<b>Warning!</b> Instead of showing the images of this comic, you will see a link to its website when the comic updates." %}</p>
		</div>
	</div>
	<div id="comic_list_wrap">
		<p><b>{% trans "Hover over a comic to see details." %}</b></p>
		<div class="save" onclick="save()" style="float:right">
			<span id="save_text">
				<img id="saved_ok" style="display:none" src="{{ mediaurl }}images/ok16.png" alt=""/>
				<img id="save_error" style="display:none" src="{{ mediaurl }}images/remove.png" alt=""/>
				{% trans "Save" %}&nbsp;
			</span>
			<span id="saving_text" style="display:none">
				<img src="{{ mediaurl }}images/loaderarrows.gif" alt=""/>
				{% trans "Saving..." %}&nbsp;
			</span>
			<img src="{{ mediaurl }}images/save24.png" alt="save"/>
		</div>
		<input id="filter" type="text" value="Escribe aquÃ­ para filtrar" class="filter" onclick="switchFilter(false)"/>
		<input id="filterReal" type="text" value="" class="filter" style="display:none" onblur="switchFilter(true)" onkeyup="filter(this.value)"/>
		<ul id="comic_list">
{% for comic in all_comics %}
			<li id="comic_{{ comic.id }}" class="comic {% if forloop.last %}last{% endif %} {% if comic.noimages %}noimages{% endif %}" {% if comic.noimages %}title="{% trans "You won't see the images of this comic" %}"{% endif %}>{{ comic }}</li>
{% endfor %}
		</ul>
	</div>
	<script type="text/javascript">
		// Ajusta la altura de la lista de comics
		$('comic_info').style.top = $('comic_list').cumulativeOffset()['top'] + "px";
		var h = $('comic_info').getDimensions()['height'];
		$('comic_list').style.height = h+"px";
	</script>
</div>
{% endblock %}