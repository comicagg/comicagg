"use strict";var comics;var lastevent;var timerid;var currentid=0;function onclick_url(a){a.stop();openurl($("comic_url").href)}function containsComicId(f,c){var e=false,d,a,b;for(d=0,a=f.length;d<a&&!e;d=d+1){b=f[d];e=b.id===c}return e?b:e}function onClickComic(c){var b,e,d,a;b=c.element();e=parseInt(b.id.substring(6),10);b.addClassName("working");b.removeClassName("error");if((a=containsComicId(usercomics,e))){d={id:e};startRequest(url_remove,{method:"post",parameters:d,dataType:"json",onSuccess:function(f){b.removeClassName("working");b.removeClassName("added");if(removeComicId(usercomics,e)){usercomics=usercomics.compact()}updateCounters(f)},onFailure:function(f){b.addClassName("error");b.removeClassName("working")}})}else{a=containsComicId(availablecomics,e);d={id:e};startRequest(url_add,{method:"post",parameters:d,dataType:"json",onSuccess:function(f){b.removeClassName("working");b.removeClassName("new");b.addClassName("added");if(removeComicId(availablecomics_new,e)){availablecomics_new=availablecomics_new.compact()}usercomics.push(a);updateCounters(f)},onFailure:function(f){b.addClassName("error");b.removeClassName("working")}})}}function mouseOverAction(){var c,e,b,a,d;c=lastevent.element();e=parseInt(c.id.substring(6),10);currentid=e;if((a=containsComicId(availablecomics_new,e))){$("comic_new").show();d={id:e};startRequest(url_forget_new_comic,{method:"post",parameters:d,dataType:"json",onSuccess:function(f){$("comic_"+e).removeClassName("new");if(removeComicId(availablecomics_new,currentid)){availablecomics_new=availablecomics_new.compact()}updateCounters(f)}})}else{if((a=containsComicId(usercomics,e))){$("comic_new").hide()}else{if((a=containsComicId(availablecomics,e))){$("comic_new").hide()}}}$("comic_info_wrap").show();$("comic_name").innerHTML=a.name;$("comic_score").innerHTML=a.score;$("comic_votes").innerHTML=a.votes;$("comic_readers").innerHTML=a.readers;$("comic_url").href=a.url;if(a.noimages){$("noimages").show();$("comic_last").hide()}else{$("noimages").hide();$("loading").show();$("comic_last").hide();b=new Image();b.src=a.last;b.id=a.id;b.onload=function(){var i,m,l,k,n,g,f,j;if(currentid!==parseInt(this.id,10)){return 0}$("loading").hide();$("comic_last").show();i=$("comic_last").cumulativeOffset().top;m=$("comic_info").getDimensions();l=$("comic_info").cumulativeOffset();k=this.width/this.height;n=$("comic_image").getDimensions().width;g=l.top+m.height-i-10;$("comic_last").style.width=this.width+"px";$("comic_last").style.height=this.height+"px";f=this.width;j=this.height;if(k>1){if(f>n){j=parseInt(n/k,10);$("comic_last").style.width=n+"px";$("comic_last").style.height=j+"px"}if(j>g){f=parseInt(g*k,10);$("comic_last").style.width=f+"px";$("comic_last").style.height=g+"px"}}else{if(j>g){f=parseInt(g*k,10);$("comic_last").style.width=f+"px";$("comic_last").style.height=g+"px"}if(f>n){j=parseInt(n/k,10);$("comic_last").style.width=n+"px";$("comic_last").style.height=j+"px"}}$("comic_last").src=this.src};b.onerror=function(){$("loading").hide();$("comic_last").show();$("comic_last").src=media_url+"images/broken32.png";$("comic_last").style.width="32px";$("comic_last").style.height="32px"}}}function onMouseOverComic(a){lastevent=a;timerid=setTimeout(function(){mouseOverAction()},500)}function onMouseOutComic(a){clearTimeout(timerid)}function initAdd(){var c,a,b,d;comics=$("add").select(".comic");for(c=0,a=comics.length;c<a;c=c+1){b=comics[c];d=parseInt(b.id.substring(6),10);if(containsComicId(usercomics,d)){b.addClassName("added")}else{if(containsComicId(availablecomics_new,d)){b.addClassName("new")}}b.observe("click",onClickComic);b.observe("mouseover",onMouseOverComic);b.observe("mouseout",onMouseOutComic)}$("comic_url").observe("click",onclick_url)}function switchFilter(a){if(a&&$("filterReal").value.length===0){$("filter").show();$("filterReal").hide()}else{$("filter").hide();$("filterReal").show();$("filterReal").focus()}}var idFilter=-1;function filter(a){clearTimeout(idFilter);idFilter=setTimeout('applyFilter("'+a+'")',100)}function applyFilter(e){var d,h,f,b,c,a,g;d=e.length;for(h=0,b=comics.length;h<b;h=h+1){c=comics[h];a=c.innerHTML.toLowerCase();g=c.className.split(" ");for(f=0;f<g.length;f=f+1){if(g[f].length>0){a+=" @"+g[f]}}if(d>0&&a.indexOf(e)<0){c.hide()}else{c.show()}}}function filter_allcomics(){$("filterReal").value="";switchFilter(true);filter("")}function filter_newcomics(){$("filterReal").value="@new";switchFilter(false);filter("@new")}function filter_addedcomics(){$("filterReal").value="@added";switchFilter(false);filter("@added")};