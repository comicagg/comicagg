"use strict";var comics;var lastevent;var timerid;var currentid=0;function onclick_url(a){a.stop();openurl($("comic_url").href)}function containsComicId(f,c){var e=false,d,a,b;for(d=0,a=f.length;d<a&&!e;d=d+1){b=f[d];e=b.id===c}return e?b:e}function onClickComic(c){var b,e,d,a;b=c.element();e=parseInt(b.id.substring(6),10);b.addClassName("working");b.removeClassName("error");if((a=containsComicId(usercomics,e))){d={id:e};startRequest(url_remove,{method:"post",parameters:d,onSuccess:function(f){if(f.status===200){b.removeClassName("added");if(removeComicId(usercomics,e)){usercomics=usercomics.compact()}}else{b.addClassName("error")}b.removeClassName("working")},onFailure:function(f){b.addClassName("error");b.removeClassName("working")}})}else{a=containsComicId(availablecomics,e);d={id:e};startRequest(url_add,{method:"post",parameters:d,onSuccess:function(f){if(f.status===200){b.removeClassName("new");b.addClassName("added");if(removeComicId(availablecomics_new,e)){availablecomics_new=availablecomics_new.compact()}usercomics.push(a)}else{b.addClassName("error")}b.removeClassName("working")},onFailure:function(f){b.addClassName("error");b.removeClassName("working")}})}}function mouseOverAction(){var c,d,b,a;c=lastevent.element();d=parseInt(c.id.substring(6),10);currentid=d;if((a=containsComicId(availablecomics_new,d))){$("comic_new").show();startRequest(a.url_forget,{onSuccess:function(e){if(e.status===200){$("comic_"+d).removeClassName("new");if(parseInt(e.responseText,10)===0){$("menuNewComicCounter").innerHTML=""}else{$("menuNewComicCounter").innerHTML=" ("+e.responseText+")"}if(removeComicId(availablecomics_new,currentid)){availablecomics_new=availablecomics_new.compact()}}}})}else{if((a=containsComicId(usercomics,d))){$("comic_new").hide()}else{if((a=containsComicId(availablecomics,d))){$("comic_new").hide()}}}$("comic_info_wrap").show();$("comic_name").innerHTML=a.name;$("comic_score").innerHTML=a.score;$("comic_votes").innerHTML=a.votes;$("comic_readers").innerHTML=a.readers;$("comic_url").href=a.url;if(a.noimages){$("noimages").show();$("comic_last").hide()}else{$("noimages").hide();$("loading").show();$("comic_last").hide();b=new Image();b.src=a.last;b.id=a.id;b.onload=function(){var g,l,k,j,m,f,e,i;if(currentid!==parseInt(this.id,10)){return 0}$("loading").hide();$("comic_last").show();g=$("comic_last").cumulativeOffset().top;l=$("comic_info").getDimensions();k=$("comic_info").cumulativeOffset();j=this.width/this.height;m=$("comic_image").getDimensions().width;f=k.top+l.height-g-10;$("comic_last").style.width=this.width+"px";$("comic_last").style.height=this.height+"px";e=this.width;i=this.height;if(j>1){if(e>m){i=parseInt(m/j,10);$("comic_last").style.width=m+"px";$("comic_last").style.height=i+"px"}if(i>f){e=parseInt(f*j,10);$("comic_last").style.width=e+"px";$("comic_last").style.height=f+"px"}}else{if(i>f){e=parseInt(f*j,10);$("comic_last").style.width=e+"px";$("comic_last").style.height=f+"px"}if(e>m){i=parseInt(m/j,10);$("comic_last").style.width=m+"px";$("comic_last").style.height=i+"px"}}$("comic_last").src=this.src};b.onerror=function(){$("loading").hide();$("comic_last").show();$("comic_last").src=media_url+"images/broken32.png";$("comic_last").style.width="32px";$("comic_last").style.height="32px"}}}function onMouseOverComic(a){lastevent=a;timerid=setTimeout(function(){mouseOverAction()},500)}function onMouseOutComic(a){clearTimeout(timerid)}function initAdd(){var c,a,b,d;comics=$("add").select(".comic");for(c=0,a=comics.length;c<a;c=c+1){b=comics[c];d=parseInt(b.id.substring(6),10);if(containsComicId(usercomics,d)){b.addClassName("added")}else{if(containsComicId(availablecomics_new,d)){b.addClassName("new")}}b.observe("click",onClickComic);b.observe("mouseover",onMouseOverComic);b.observe("mouseout",onMouseOutComic)}$("comic_url").observe("click",onclick_url)}function switchFilter(a){if(a&&$("filterReal").value.length===0){$("filter").show();$("filterReal").hide()}else{$("filter").hide();$("filterReal").show();$("filterReal").focus()}}var idFilter=-1;function filter(a){clearTimeout(idFilter);idFilter=setTimeout('applyFilter("'+a+'")',100)}function applyFilter(e){var d,h,f,b,c,a,g;d=e.length;for(h=0,b=comics.length;h<b;h=h+1){c=comics[h];a=c.innerHTML.toLowerCase();g=c.className.split(" ");for(f=0;f<g.length;f=f+1){if(g[f].length>0){a+=" @"+g[f]}}if(d>0&&a.indexOf(e)<0){c.hide()}else{c.show()}}}function filter_allcomics(){$("filterReal").value="";switchFilter(true);filter("")}function filter_newcomics(){$("filterReal").value="@new";switchFilter(false);filter("@new")}function filter_addedcomics(){$("filterReal").value="@added";switchFilter(false);filter("@added")};